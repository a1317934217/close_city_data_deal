# coding:utf-8
"""
@file: section_two_down_Pic.py
@author: wu hao
@time: 2023/5/16 20:17
@env: 封城数据处理
@desc:
@ref:
"""

import datetime
from math import e
from math import log

# coding=utf-8
import matplotlib.pyplot as plt
import networkx as nx
import numpy as np
import pandas as pd
from matplotlib.ticker import FuncFormatter, MaxNLocator
from numpy import array
# 根据路径画图
from sklearn.preprocessing import MinMaxScaler
from tqdm import tqdm

def getdaylist(begin, end):
    """
    获取时间列表
    """
    beginDate = datetime.datetime.strptime(str(begin), "%Y%m%d")
    endDate = datetime.datetime.strptime(str(end), "%Y%m%d")
    dayList = []
    while beginDate <= endDate:
        dayList.append(datetime.datetime.strftime(beginDate, "%Y%m%d"))
        beginDate += datetime.timedelta(days=+1)
    return dayList


list_avarge_node_beijing =  [2.8, 2.4545454545454546, 2.4545454545454546, 2.618181818181818, 3.1818181818181817, 2.7818181818181817, 3.1818181818181817, 3.018181818181818, 2.8363636363636364, 2.8363636363636364, 2.8363636363636364, 3.1818181818181817, 2.8363636363636364, 3.1818181818181817, 3.018181818181818, 2.8363636363636364, 3.018181818181818, 3.3636363636363638, 3.5454545454545454, 3.5454545454545454, 3.727272727272727, 3.1818181818181817, 3.5636363636363635, 3.3636363636363638, 3.1818181818181817, 3.3636363636363638, 3.0, 4.127272727272727, 3.7454545454545456, 3.9272727272727272, 3.9272727272727272, 4.963636363636364, 3.3636363636363638, 3.5454545454545454, 3.0, 1.4, 3.1818181818181817, 2.2181818181818183, 2.0545454545454547, 1.7454545454545454, 1.6181818181818182, 1.6181818181818182, 1.6, 1.6, 1.4, 1.4181818181818182, 1.4181818181818182, 1.4, 1.4, 1.5454545454545454, 1.5454545454545454, 1.5454545454545454, 1.5636363636363637, 1.6181818181818182, 1.5636363636363637, 1.6181818181818182, 1.7272727272727273, 1.7454545454545454, 1.6, 1.4181818181818182, 1.8909090909090909, 1.8545454545454545, 1.8909090909090909, 1.8909090909090909, 2.018181818181818, 2.018181818181818, 2.018181818181818, 2.309090909090909, 2.1272727272727274, 2.1272727272727274, 2.272727272727273, 2.272727272727273, 2.4545454545454546, 1.8545454545454545, 1.9090909090909092, 1.9454545454545455, 2.0727272727272728, 2.4545454545454546, 3.8363636363636364, 3.7818181818181817, 3.309090909090909, 3.4363636363636365, 3.618181818181818, 3.1818181818181817, 3.018181818181818, 2.672727272727273, 2.8545454545454545, 2.4545454545454546, 3.3636363636363638, 3.418181818181818, 3.3636363636363638, 3.5454545454545454, 3.5454545454545454, 3.1818181818181817, 3.018181818181818, 3.3636363636363638, 2.8545454545454545, 3.5454545454545454, 3.1818181818181817, 3.1818181818181817, 3.1818181818181817, 3.3636363636363638, 3.9272727272727272, 3.5454545454545454, 3.3636363636363638, 3.3636363636363638, 3.7454545454545456, 3.1818181818181817, 3.7454545454545456, 4.1454545454545455, 3.018181818181818, 3.9454545454545453, 3.381818181818182, 3.5636363636363635, 3.5636363636363635, 3.7454545454545456, 4.127272727272727, 3.5636363636363635, 4.327272727272727, 4.127272727272727, 3.9272727272727272, 3.9454545454545453, 4.327272727272727, 5.4, 4.327272727272727, 4.745454545454545, 5.8545454545454545, 4.945454545454545, 4.545454545454546, 4.472727272727273, 4.327272727272727, 3.9272727272727272, 4.127272727272727, 3.9454545454545453, 4.127272727272727, 4.127272727272727, 4.327272727272727, 4.527272727272727, 4.327272727272727, 4.527272727272727, 4.127272727272727, 3.9454545454545453, 3.9454545454545453, 4.127272727272727, 4.327272727272727, 3.9454545454545453, 4.127272727272727, 3.9454545454545453, 4.127272727272727, 4.127272727272727, 5.163636363636364, 6.581818181818182, 5.8545454545454545, 5.381818181818182, 5.163636363636364, 6.345454545454546, 5.4, 4.7272727272727275, 4.527272727272727]

list_degree_beijing =  [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 7, 10, 9, 9, 9, 8, 8, 7, 7, 7, 8, 8, 8, 8, 7, 7, 7, 8, 8, 8, 8, 8, 9, 7, 6, 7, 6, 7, 7, 8, 8, 8, 10, 9, 9, 9, 9, 9, 6, 5, 6, 7, 9, 9, 10, 10, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10]

list_edge_beijing =  [24, 22, 22, 23, 27, 24, 27, 26, 25, 25, 25, 27, 25, 27, 26, 25, 26, 28, 29, 29, 30, 27, 29, 28, 27, 28, 26, 32, 30, 31, 31, 36, 28, 29, 26, 14, 27, 21, 20, 18, 17, 17, 16, 16, 14, 15, 15, 14, 14, 15, 15, 15, 16, 17, 16, 17, 17, 18, 16, 15, 18, 16, 18, 18, 19, 19, 19, 21, 20, 20, 21, 21, 22, 16, 16, 18, 19, 22, 30, 30, 27, 28, 29, 27, 26, 24, 25, 22, 28, 28, 28, 29, 29, 27, 26, 28, 25, 29, 27, 27, 27, 28, 31, 29, 28, 28, 30, 27, 30, 32, 26, 31, 28, 29, 29, 30, 32, 29, 33, 32, 31, 31, 33, 38, 33, 35, 40, 36, 34, 33, 33, 31, 32, 31, 32, 32, 33, 34, 33, 34, 32, 31, 31, 32, 33, 31, 32, 31, 32, 32, 37, 43, 40, 38, 37, 42, 38, 35, 34]

list_nature_beijing = [3.023038088187187, 2.7384240977439824, 2.7384240977439824, 2.9402570215266364, 3.6283687947124736, 3.080987424001337, 3.6283687947124736, 3.4557525196720795, 3.3656897884828827, 3.3656897884828827, 3.3656897884828827, 3.6107273274225675, 3.3656897884828827, 3.6283687947124683, 3.4557525196720795, 3.3656897884828827, 3.4557525196720795, 3.7352680594282943, 3.901898197428117, 3.9394846660330667, 4.097716315910888, 3.6283687947124736, 4.045033264937264, 3.8269981507715762, 3.6283687947124736, 3.8269981507715762, 3.544436147906716, 4.437132438145998, 4.187743711046614, 4.294752076404723, 4.294752076404723, 4.970613071144773, 3.7670874180953455, 3.9394846660330667, 3.544436147906721, 1.4775723438504142, 3.615943332904473, 2.596242549937813, 2.543283372799452, 2.3296452247173223, 2.0572431888574494, 2.0572431888574494, 1.8830528175560972, 1.8830528175560972, 1.513739154233181, 1.7290854223020757, 1.7290854223020757, 1.5319261275845435, 1.5319261275845435, 1.6159711759816762, 1.6159711759816762, 1.6159711759816762, 1.80674382158783, 2.0572431888574494, 1.80674382158783, 2.0572431888574494, 2.15967029731973, 2.3296452247173223, 1.8830528175560972, 1.662340167669256, 2.0962261333166627, 1.6561111805777498, 2.0962261333166627, 2.0962261333166627, 2.356122005656498, 2.356122005656498, 2.356122005656498, 2.5709105185984837, 2.5191559186643144, 2.5191559186643144, 2.690817384513317, 2.690817384513317, 2.7673484640763575, 1.6561111805777498, 1.6227802913047662, 2.0637348582826247, 2.3190754798825552, 2.7881225604842057, 3.999110069915328, 3.9053991399980776, 3.3934220828480526, 3.7774807049887507, 3.8077415165425395, 3.5921511386539096, 3.373313785113595, 3.167974537718747, 3.1959633523125137, 2.7384240977439824, 3.703287594806066, 3.6603833714578453, 3.796394729538834, 3.962472990480595, 3.962472990480595, 3.5921511386539096, 3.373313785113595, 3.7225600871853226, 3.1959633523125137, 3.888725460805916, 3.6969876513292923, 3.6969876513292923, 3.749890665450422, 3.8269981507715762, 4.2947520764047304, 3.9623048412207154, 3.8203390050383206, 3.8269981507715762, 4.024197690175753, 3.6969876513292923, 3.980569205307784, 4.339612339300585, 3.4245938040666943, 4.125060882378593, 3.7092161604551532, 3.885102383433414, 3.812071365360625, 3.980569205307784, 4.361997633109546, 4.039280687060665, 4.50139428005421, 4.356975907833597, 4.294752076404723, 4.253006839790809, 4.469124298930488, 5.1772215903094985, 4.537429859387563, 4.809649474738632, 5.505034417891729, 4.929675571579057, 4.750384543982385, 4.510559588404602, 4.457529079053746, 4.294752076404723, 4.356975907833597, 4.213714919361937, 4.356975907833597, 4.356975907833597, 4.50139428005421, 4.6033536438426355, 4.457529079053746, 4.6033536438426355, 4.356975907833597, 4.253006839790809, 4.253006839790809, 4.356975907833597, 4.457529079053746, 4.253006839790809, 4.356975907833597, 4.253006839790809, 4.356975907833597, 4.356975907833597, 5.027745475687224, 5.951460455524055, 5.489572712352488, 5.193981266344836, 5.027745475687224, 5.813037887539801, 5.1772215903094985, 4.751981904447129, 4.6033536438426355]




list_avarge_node_tianjin =  [2.8, 2.4545454545454546, 2.4545454545454546, 2.8, 3.5636363636363635, 2.963636363636364, 3.5636363636363635, 3.018181818181818, 2.8363636363636364, 2.8363636363636364, 3.018181818181818, 3.5636363636363635, 3.018181818181818, 3.5636363636363635, 3.2181818181818183, 3.018181818181818, 3.018181818181818, 3.5636363636363635, 3.9454545454545453, 3.7454545454545456, 4.127272727272727, 3.381818181818182, 3.5636363636363635, 3.5636363636363635, 3.381818181818182, 3.5636363636363635, 3.0, 4.527272727272727, 3.7454545454545456, 3.9272727272727272, 4.745454545454545, 5.618181818181818, 3.5636363636363635, 3.9454545454545453, 3.5636363636363635, 1.2363636363636363, 3.1818181818181817, 2.0545454545454547, 2.0545454545454547, 1.7454545454545454, 1.6181818181818182, 1.6181818181818182, 1.4727272727272727, 1.4727272727272727, 1.2727272727272727, 1.4181818181818182, 1.4181818181818182, 1.4, 1.4, 1.4181818181818182, 1.4181818181818182, 1.4181818181818182, 1.5636363636363637, 1.6181818181818182, 1.5636363636363637, 1.6181818181818182, 1.6, 1.8727272727272728, 1.4727272727272727, 1.6, 1.9090909090909092, 1.5636363636363637, 2.0727272727272728, 2.0727272727272728, 2.2, 2.2, 2.2, 2.4727272727272727, 2.4727272727272727, 2.4727272727272727, 2.8, 2.8, 3.0, 1.7454545454545454, 1.9272727272727272, 2.1272727272727274, 2.2545454545454544, 2.6363636363636362, 4.3090909090909095, 4.072727272727272, 3.727272727272727, 4.036363636363636, 4.036363636363636, 3.7636363636363637, 3.2, 2.8363636363636364, 2.8545454545454545, 2.4545454545454546, 3.7636363636363637, 3.8181818181818183, 3.9454545454545453, 4.127272727272727, 4.127272727272727, 3.7636363636363637, 3.4, 3.7636363636363637, 2.8545454545454545, 4.163636363636364, 3.3636363636363638, 3.3636363636363638, 3.3636363636363638, 3.5636363636363635, 4.545454545454546, 3.7454545454545456, 3.9454545454545453, 3.9454545454545453, 4.127272727272727, 3.7454545454545456, 4.163636363636364, 4.545454545454546, 4.036363636363636, 4.363636363636363, 3.5636363636363635, 3.5636363636363635, 3.5636363636363635, 4.163636363636364, 4.545454545454546, 4.1454545454545455, 4.745454545454545, 4.327272727272727, 4.545454545454546, 4.327272727272727, 4.545454545454546, 5.381818181818182, 4.745454545454545, 4.945454545454545, 5.836363636363636, 5.381818181818182, 4.963636363636364, 4.745454545454545, 4.545454545454546, 4.545454545454546, 4.545454545454546, 4.363636363636363, 4.545454545454546, 4.545454545454546, 4.745454545454545, 4.745454545454545, 4.545454545454546, 4.745454545454545, 4.545454545454546, 4.327272727272727, 4.327272727272727, 4.545454545454546, 4.545454545454546, 4.327272727272727, 4.545454545454546, 4.327272727272727, 4.545454545454546, 4.545454545454546, 5.163636363636364, 7.3090909090909095, 6.3090909090909095, 6.072727272727272, 5.836363636363636, 6.8, 5.618181818181818, 5.163636363636364, 4.745454545454545]

list_degree_tianjin =   [6, 6, 6, 7, 8, 7, 8, 7, 7, 7, 8, 8, 8, 9, 8, 8, 7, 8, 9, 8, 9, 8, 8, 8, 8, 8, 8, 10, 8, 8, 9, 10, 9, 9, 9, 4, 8, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 6, 6, 6, 6, 6, 6, 7, 6, 7, 7, 7, 7, 5, 6, 5, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 6, 6, 7, 7, 7, 9, 9, 9, 10, 10, 9, 8, 8, 8, 7, 9, 9, 9, 9, 9, 9, 9, 10, 8, 10, 9, 9, 9, 10, 10, 9, 9, 9, 9, 9, 10, 10, 9, 10, 8, 8, 8, 10, 10, 9, 10, 8, 9, 9, 10, 10, 10, 10, 10, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 9, 10, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10]

list_edge_tianjin =  [24, 22, 22, 24, 29, 25, 29, 26, 25, 25, 26, 29, 26, 29, 27, 26, 26, 29, 31, 30, 32, 28, 29, 29, 28, 29, 26, 34, 30, 31, 35, 39, 29, 31, 29, 13, 27, 20, 20, 18, 17, 17, 16, 16, 14, 15, 15, 14, 14, 15, 15, 15, 16, 17, 16, 17, 17, 19, 16, 16, 18, 15, 19, 19, 20, 20, 20, 22, 22, 22, 24, 24, 25, 16, 17, 19, 20, 23, 32, 31, 29, 31, 31, 30, 27, 25, 25, 22, 30, 30, 31, 32, 32, 30, 28, 30, 25, 32, 28, 28, 28, 29, 34, 30, 31, 31, 32, 30, 32, 34, 31, 33, 29, 29, 29, 32, 34, 32, 35, 33, 34, 33, 34, 38, 35, 36, 40, 38, 36, 35, 34, 34, 34, 33, 34, 34, 35, 35, 34, 35, 34, 33, 33, 34, 34, 33, 34, 33, 34, 34, 37, 46, 42, 41, 40, 44, 39, 37, 35]

list_nature_tianjin = [3.0080690347030767, 2.721893953022827, 2.721893953022827, 3.006323401218226, 3.812071365360622, 3.14126592594255, 3.812071365360622, 3.4427292076080582, 3.353245816325759, 3.353245816325759, 3.4313279135635435, 3.79630052599258, 3.4313279135635435, 3.8188659402595535, 3.5166496530544173, 3.4313279135635435, 3.4427292076080582, 3.787199502898974, 4.073479063670647, 3.98647458132418, 4.255759527339414, 3.6843027998547546, 4.034949267751022, 3.8778655289980524, 3.6843027998547546, 3.8778655289980524, 3.5372158932994644, 4.587732985074746, 4.177789615189769, 4.283197552678144, 4.678789909249926, 5.243802196756104, 3.819821549726163, 4.094923475962776, 3.8547448837965796, 1.4057347869884376, 3.613988672433172, 2.497890840398286, 2.5317468671235983, 2.330964696664455, 2.053490266183121, 2.053490266183121, 1.9259801113771098, 1.9259801113771098, 1.5332518791416065, 1.6898130411812504, 1.6898130411812504, 1.4652526996109436, 1.4652526996109436, 1.6420427482633797, 1.6420427482633797, 1.6420427482633797, 1.7785083426531596, 2.053490266183121, 1.7785083426531596, 2.053490266183121, 2.200714727923616, 2.5261132529419603, 1.9259801113771098, 1.7002211202515145, 2.031777211343735, 1.579872804502274, 2.1434415627150547, 2.1434415627150547, 2.40856781035256, 2.40856781035256, 2.40856781035256, 2.739912659575705, 2.739912659575705, 2.739912659575705, 2.986082683147906, 2.986082683147906, 3.0515684242157004, 1.6341949160513887, 1.7088334451605505, 2.1172835927990485, 2.375685236343713, 2.8283536195976167, 4.051960657726321, 3.9303897456064494, 3.6178659652482366, 3.991138805809168, 3.991138805809168, 3.889063559799568, 3.512693050934251, 3.3285314550217855, 3.1940597133360087, 2.735613248859007, 3.889063559799568, 3.86016331955022, 4.069613146539514, 4.224934440090916, 4.224934440090916, 3.889063559799568, 3.5730834313538113, 3.893435170632731, 3.1940597133360087, 4.171977851385286, 3.754350482770855, 3.754350482770855, 3.815992482938377, 3.895198013978796, 4.558120687968745, 4.0191323224367395, 4.102560757459522, 4.122384319905798, 4.2344646920230415, 3.9894133281770414, 4.183860933560772, 4.556227497790198, 4.041974577727854, 4.316861613053461, 3.812071365360622, 3.8712226642017136, 3.787199502898974, 4.183860933560772, 4.558120687968738, 4.316663013423114, 4.6874300524260715, 4.4469733669617995, 4.545289548769273, 4.45050952735293, 4.558120687968738, 5.098444264777735, 4.6874300524260715, 4.831036213990646, 5.428034618726179, 5.117538204891724, 4.87715847289268, 4.705298913110166, 4.545289548769273, 4.545289548769273, 4.545289548769273, 4.412649678892104, 4.545289548769273, 4.545289548769273, 4.6874300524260715, 4.6874300524260715, 4.545289548769273, 4.6874300524260715, 4.545289548769273, 4.45050952735293, 4.45050952735293, 4.545289548769273, 4.545289548769273, 4.45050952735293, 4.545289548769273, 4.45050952735293, 4.545289548769273, 4.545289548769273, 4.980818960817629, 6.242439349661625, 5.729703118494938, 5.563591323588176, 5.41232361211846, 5.968067824317859, 5.243802196756105, 4.954612431648657, 4.6874300524260715]




list_avarge_node_xingtai =  [4.036363636363636, 3.8363636363636364, 3.8363636363636364, 4.036363636363636, 4.1454545454545455, 4.036363636363636, 4.3090909090909095, 4.127272727272727, 4.127272727272727, 4.127272727272727, 4.127272727272727, 4.1454545454545455, 4.127272727272727, 4.1454545454545455, 4.127272727272727, 4.127272727272727, 4.127272727272727, 4.127272727272727, 4.236363636363636, 4.218181818181818, 4.1454545454545455, 4.127272727272727, 4.127272727272727, 4.127272727272727, 4.127272727272727, 4.127272727272727, 4.127272727272727, 4.472727272727273, 4.290909090909091, 4.472727272727273, 4.7272727272727275, 5.781818181818182, 4.218181818181818, 4.127272727272727, 3.9272727272727272, 1.4, 3.036363636363636, 2.2363636363636363, 2.3636363636363638, 1.7272727272727273, 1.0545454545454545, 1.0545454545454545, 1.0545454545454545, 1.0545454545454545, 0.8545454545454545, 0.8545454545454545, 1.1454545454545455, 0.8363636363636363, 0.8363636363636363, 1.0, 1.0, 1.0, 1.0, 1.0545454545454545, 1.0, 1.0545454545454545, 1.1818181818181819, 1.1818181818181819, 1.0545454545454545, 1.5454545454545454, 1.5818181818181818, 1.5636363636363637, 1.9090909090909092, 1.5818181818181818, 1.709090909090909, 2.018181818181818, 2.4727272727272727, 3.1272727272727274, 2.9272727272727272, 3.2545454545454544, 3.3454545454545452, 3.1818181818181817, 3.1454545454545455, 2.2363636363636363, 2.327272727272727, 2.3454545454545452, 2.4727272727272727, 2.963636363636364, 4.090909090909091, 4.781818181818182, 4.127272727272727, 4.490909090909091, 4.509090909090909, 4.4363636363636365, 4.236363636363636, 4.109090909090909, 3.5636363636363635, 3.290909090909091, 4.618181818181818, 4.872727272727273, 4.872727272727273, 5.072727272727272, 4.872727272727273, 4.4363636363636365, 4.109090909090909, 4.418181818181818, 3.9454545454545453, 4.418181818181818, 4.290909090909091, 4.290909090909091, 4.127272727272727, 4.127272727272727, 4.6, 4.472727272727273, 4.509090909090909, 4.218181818181818, 4.509090909090909, 4.6, 4.509090909090909, 4.4363636363636365, 4.127272727272727, 4.618181818181818, 4.1454545454545455, 4.1454545454545455, 4.218181818181818, 4.454545454545454, 4.909090909090909, 4.545454545454546, 5.072727272727272, 4.6, 4.6, 4.618181818181818, 4.909090909090909, 6.072727272727272, 5.381818181818182, 5.781818181818182, 5.836363636363636, 5.072727272727272, 4.872727272727273, 4.472727272727273, 4.909090909090909, 4.472727272727273, 4.490909090909091, 4.290909090909091, 4.472727272727273, 4.472727272727273, 4.945454545454545, 5.454545454545454, 4.6, 5.072727272727272, 4.618181818181818, 4.781818181818182, 4.472727272727273, 4.490909090909091, 4.781818181818182, 4.472727272727273, 4.781818181818182, 4.472727272727273, 4.945454545454545, 5.127272727272727, 5.836363636363636, 8.454545454545455, 8.145454545454545, 7.290909090909091, 7.072727272727272, 7.581818181818182, 6.581818181818182, 5.454545454545454, 4.745454545454545]

list_degree_xingtai = [5, 5, 5, 5, 5, 5, 6, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 5, 6, 7, 7, 6, 7, 4, 2, 3, 2, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 2, 2, 2, 3, 4, 4, 4, 4, 3, 4, 3, 3, 3, 3, 3, 4, 5, 5, 6, 5, 5, 5, 5, 5, 4, 6, 7, 6, 7, 6, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 7, 6, 6, 6, 7, 6, 5, 6, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 7, 8, 7, 7, 8, 7, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 10, 10, 9, 10, 10, 9, 7, 7]

list_edge_xingtai = [29, 28, 28, 29, 31, 29, 32, 30, 30, 30, 30, 31, 30, 31, 30, 30, 30, 30, 32, 31, 31, 30, 30, 30, 30, 30, 30, 32, 31, 32, 34, 39, 32, 32, 30, 15, 27, 21, 20, 17, 14, 14, 14, 14, 12, 12, 13, 11, 11, 13, 13, 13, 13, 14, 13, 14, 15, 15, 14, 15, 17, 16, 18, 17, 18, 19, 21, 25, 24, 26, 27, 27, 26, 18, 19, 20, 21, 25, 31, 33, 31, 33, 33, 33, 32, 31, 28, 26, 34, 35, 35, 36, 35, 33, 31, 32, 29, 32, 31, 31, 30, 30, 33, 32, 33, 31, 33, 33, 33, 33, 30, 34, 31, 31, 31, 32, 35, 33, 35, 33, 33, 34, 35, 41, 38, 38, 40, 36, 35, 32, 34, 32, 33, 31, 32, 32, 34, 36, 33, 35, 34, 33, 32, 33, 33, 32, 33, 32, 34, 36, 40, 50, 49, 45, 44, 47, 42, 37, 35]

list_nature_xingtai = [3.527422708905934, 3.33196347763694, 3.33196347763694, 3.527422708905934, 3.8743370794252265, 3.527422708905934, 4.050646283056275, 3.7649341138800896, 3.7649341138800896, 3.7649341138800896, 3.7649341138800896, 3.8743370794252265, 3.7649341138800896, 3.8743370794252265, 3.7649341138800896, 3.7649341138800896, 3.7649341138800896, 3.7649341138800896, 4.07277682971899, 3.973355417321733, 3.8743370794252265, 3.7649341138800896, 3.7649341138800896, 3.7649341138800896, 3.7649341138800896, 3.7649341138800896, 3.7649341138800896, 4.137864180098321, 3.947149663505162, 4.137864180098321, 4.535605565655205, 5.235817934320807, 4.294897253549572, 4.323318815748306, 3.8490540595508107, 1.5322226496311517, 3.7563028605799516, 2.560670822785211, 2.2425087618725934, 2.088382097371952, 1.7187841782823097, 1.7187841782823097, 1.7187841782823097, 1.7187841782823097, 1.2973629760660967, 1.2973629760660967, 1.3644714024656321, 1.071307937541252, 1.071307937541252, 1.4378496397870257, 1.4378496397870257, 1.4378496397870257, 1.4378496397870257, 1.7187841782823097, 1.4378496397870257, 1.7187841782823097, 1.9993035751170183, 1.9993035751170183, 1.7187841782823097, 1.5199892707849643, 1.8938593770208705, 1.6243203992364743, 1.9191083131476798, 1.8938593770208705, 2.1454590691046658, 2.190165377997137, 2.3444188271971518, 2.872817113249239, 2.7952811647963345, 3.032958903837008, 3.2355022059203464, 3.3840942235260734, 3.172248189555601, 1.713380692176914, 1.8063325552958591, 2.053054813350179, 2.266939444269176, 3.009299016475192, 3.8673007833848203, 4.120927950386155, 3.8392988649477386, 4.352588346816287, 4.2119404461611065, 4.244755250269974, 4.06390579295558, 3.8655553398544042, 3.509957744217628, 3.100414738340994, 4.425759250144236, 4.603914412339529, 4.589585658648625, 4.787091291226114, 4.589585658648625, 4.244755250269974, 3.8655553398544042, 4.146203509390699, 3.554626851672382, 4.146203509390699, 3.947149663505162, 3.947149663505162, 3.7649341138800896, 3.7649341138800896, 4.327797160721089, 4.137864180098321, 4.3556845216667135, 3.940680544044818, 4.22466100778302, 4.327797160721084, 4.3556845216667135, 4.241427425527163, 3.7649341138800896, 4.425759250144236, 3.8743370794252265, 3.8743370794252265, 3.940680544044818, 4.020352328127872, 4.527340783176082, 4.242133515883034, 4.498230920165693, 4.327797160721089, 4.327797160721089, 4.425759250144232, 4.532718484831101, 5.54467247348904, 4.999520824335071, 4.953631651264939, 5.355628603091768, 4.787091291226114, 4.589585658648623, 4.137864180098321, 4.396263322920002, 4.137864180098321, 4.244303510083961, 3.9425677019967362, 4.137864180098321, 4.137864180098321, 4.313157906002761, 4.591477979619266, 4.327797160721089, 4.498230920165693, 4.425759250144236, 4.202882406908337, 4.137864180098321, 4.244303510083961, 4.202882406908337, 4.137864180098321, 4.202882406908337, 4.137864180098321, 4.313157906002761, 4.70692719879424, 5.35562860309179, 6.879383253524387, 6.700157404916885, 5.997578671778496, 5.909303421044306, 6.374749811464378, 5.6209449693457705, 4.8591934253052775, 4.631025814760527]






list_avarge_node_hengshui=   [3.2181818181818183, 2.8363636363636364, 2.8363636363636364, 3.3636363636363638, 4.236363636363636, 3.6363636363636362, 4.454545454545454, 3.5636363636363635, 3.3636363636363638, 3.3636363636363638, 3.690909090909091, 4.236363636363636, 3.690909090909091, 4.236363636363636, 3.890909090909091, 3.690909090909091, 3.5636363636363635, 4.290909090909091, 4.763636363636364, 4.545454545454546, 4.872727272727273, 4.072727272727272, 4.472727272727273, 4.2727272727272725, 4.072727272727272, 4.2727272727272725, 3.8727272727272726, 5.109090909090909, 4.472727272727273, 4.890909090909091, 5.618181818181818, 6.545454545454546, 4.327272727272727, 5.181818181818182, 4.127272727272727, 1.2727272727272727, 3.690909090909091, 2.090909090909091, 2.309090909090909, 1.5818181818181818, 1.4545454545454546, 1.4545454545454546, 1.309090909090909, 1.309090909090909, 1.1090909090909091, 1.2545454545454546, 1.2545454545454546, 1.2363636363636363, 1.2363636363636363, 1.2545454545454546, 1.2545454545454546, 1.2545454545454546, 1.4, 1.4545454545454546, 1.4, 1.4545454545454546, 1.4363636363636363, 1.709090909090909, 1.309090909090909, 1.5272727272727273, 1.5818181818181818, 1.3636363636363635, 1.8, 1.8, 1.9272727272727272, 2.290909090909091, 2.4363636363636365, 2.8727272727272726, 2.8727272727272726, 2.963636363636364, 3.109090909090909, 3.2, 3.309090909090909, 1.8727272727272728, 2.1636363636363636, 2.3636363636363638, 2.4909090909090907, 2.963636363636364, 4.290909090909091, 4.2, 4.0, 4.363636363636363, 4.163636363636364, 4.127272727272727, 3.9454545454545453, 3.4545454545454546, 3.709090909090909, 2.963636363636364, 4.327272727272727, 4.327272727272727, 4.327272727272727, 4.745454545454545, 4.545454545454546, 4.127272727272727, 3.8545454545454545, 4.163636363636364, 3.709090909090909, 4.545454545454546, 3.8727272727272726, 3.8727272727272726, 4.072727272727272, 4.2727272727272725, 5.163636363636364, 4.472727272727273, 4.963636363636364, 4.6909090909090905, 4.6909090909090905, 4.345454545454546, 5.2, 5.163636363636364, 4.036363636363636, 5.0, 4.236363636363636, 4.2727272727272725, 4.527272727272727, 5.1454545454545455, 6.072727272727272, 4.945454545454545, 5.618181818181818, 5.163636363636364, 5.163636363636364, 4.945454545454545, 5.618181818181818, 6.8, 5.836363636363636, 6.072727272727272, 7.054545454545455, 5.909090909090909, 5.163636363636364, 5.072727272727272, 5.163636363636364, 5.072727272727272, 5.072727272727272, 5.072727272727272, 5.072727272727272, 5.072727272727272, 5.3090909090909095, 5.4, 5.163636363636364, 5.4, 5.163636363636364, 4.8545454545454545, 4.8545454545454545, 5.072727272727272, 5.072727272727272, 4.8545454545454545, 5.072727272727272, 4.8545454545454545, 5.072727272727272, 5.381818181818182, 6.545454545454546, 8.418181818181818, 7.3090909090909095, 6.8545454545454545, 6.545454545454546, 7.581818181818182, 6.545454545454546, 5.618181818181818, 5.618181818181818]

list_degree_hengshui =  [6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 10, 7, 8, 7, 1, 5, 4, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 4, 4, 4, 5, 5, 6, 5, 3, 4, 4, 4, 5, 6, 7, 7, 7, 7, 7, 7, 6, 6, 6, 7, 7, 7, 7, 7, 7, 6, 7, 6, 7, 6, 6, 6, 6, 7, 6, 7, 6, 6, 7, 7, 7, 6, 7, 6, 6, 6, 7, 10, 7, 8, 7, 7, 7, 7, 10, 8, 8, 9, 7, 7, 6, 7, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 6, 6, 6, 6, 6, 6, 6, 6, 7, 10, 10, 10, 9, 8, 9, 8, 7, 7]

list_edge_hengshui =  [27, 25, 25, 27, 32, 28, 33, 29, 28, 28, 29, 32, 29, 32, 30, 29, 29, 32, 35, 34, 35, 31, 33, 32, 31, 32, 30, 36, 33, 35, 39, 43, 33, 37, 32, 13, 29, 20, 21, 17, 16, 16, 15, 15, 13, 14, 14, 13, 13, 14, 14, 14, 15, 16, 15, 16, 16, 18, 15, 16, 17, 14, 18, 18, 19, 20, 21, 24, 24, 25, 26, 27, 27, 16, 19, 21, 22, 25, 32, 32, 31, 33, 32, 32, 31, 28, 29, 25, 33, 33, 33, 35, 34, 32, 30, 32, 29, 34, 30, 30, 31, 32, 37, 33, 36, 34, 34, 33, 37, 37, 31, 36, 32, 32, 33, 36, 41, 36, 39, 37, 37, 36, 39, 44, 40, 41, 45, 40, 37, 36, 37, 36, 36, 36, 36, 36, 37, 38, 37, 38, 37, 35, 35, 36, 36, 35, 36, 35, 36, 38, 43, 50, 46, 44, 43, 47, 43, 39, 39]

list_nature_hengshui =  [3.4212663659244904, 3.146753712730733, 3.146753712730733, 3.432161933700399, 4.14627684213134, 3.540556694250969, 4.272504289590334, 3.77806906648422, 3.6947718917086143, 3.6947718917086143, 3.7883181019817567, 4.1340692009684865, 3.7883181019817567, 4.138914321560796, 3.867295487768595, 3.7883181019817567, 3.77806906648422, 4.099546231524995, 4.589621661398068, 4.475907396250273, 4.541495791169154, 3.9968257134649146, 4.378174878699441, 4.170206552707835, 3.9968257134649146, 4.170206552707835, 3.9389480691743066, 4.726849939392421, 4.378174878699441, 4.606538176532115, 5.1650202369634926, 5.82294705146369, 4.33520926364351, 4.8850017606646325, 4.259543327918671, 1.3136868192677686, 3.7666692943521474, 2.3532065596059075, 2.5701251059343626, 2.2422283322659244, 1.960525673606654, 1.960525673606654, 1.8540015783035508, 1.8540015783035508, 1.4371810193914265, 1.5674156374456878, 1.5674156374456878, 1.3494214500441934, 1.3494214500441934, 1.5831009413437995, 1.5831009413437995, 1.5831009413437995, 1.6933808404863886, 1.960525673606654, 1.6933808404863886, 1.960525673606654, 2.1286813279797903, 2.4523491604198533, 1.8540015783035508, 1.61827965150244, 1.8802330099225932, 1.411338369001459, 2.0179472563243466, 2.0179472563243466, 2.2900750242379924, 2.3288862314579952, 2.48618168545571, 2.9418221647955525, 2.9418221647955525, 3.15426575542699, 3.344055098842426, 3.5610638358660203, 3.407020124105423, 1.5428789605083317, 1.9721309672502383, 2.3327288232773613, 2.585501089302895, 3.144478521704687, 4.089563892883596, 4.0471260806030145, 3.9317643870210213, 4.300787639049995, 4.147482341653892, 4.216405432961822, 4.0326044118983555, 3.6439170273569346, 3.62312408949347, 3.1154301642626616, 4.348214390726289, 4.354260321733806, 4.362435451554854, 4.647824369023496, 4.492510389972278, 4.216405432961822, 3.7960950200818115, 4.171607998921424, 3.62312408949347, 4.452971472104736, 3.921269884926926, 3.921269884926926, 4.11033002343814, 4.171834098041243, 4.913169453666453, 4.302607710584389, 4.8052884650910075, 4.448538068057459, 4.435614666230445, 4.440777705036342, 4.878119201990962, 4.9131694536664545, 3.9920820202109604, 4.709380153468976, 4.14627684213134, 4.167383538458531, 4.230639445291431, 4.639301088828661, 5.553568695350648, 4.826692794894761, 5.165020236963488, 4.913416850489592, 4.913416850489592, 4.826692794894761, 5.18859548647314, 5.968067824317859, 5.361942850263475, 5.487830736062125, 6.10941874882078, 5.309204381852102, 4.913416850489592, 4.729248392460012, 4.913416850489592, 4.729248392460012, 4.729248392460012, 4.729248392460012, 4.729248392460012, 4.729248392460012, 4.846608417665867, 5.035336160770069, 4.913416850489592, 5.035336160770069, 4.913416850489592, 4.631718670121852, 4.631718670121852, 4.729248392460012, 4.729248392460012, 4.631718670121852, 4.729248392460012, 4.631718670121852, 4.729248392460012, 5.06375610070158, 5.82294705146369, 6.800741166524243, 6.222800066031659, 5.921311804696507, 5.815578774521662, 6.33450374005989, 5.815578774521662, 5.18859548647314, 5.18859548647314]








def down_propotion_slice(list_name):
    list_propotion_one = []
    list_propotion_two = []
    list_propotion_three = []
    list_name_list = [list_propotion_one,list_propotion_two,list_propotion_three]
    for index_name,listname in zip(list_name,list_name_list):
        #range(0,115), range(22, 128)
        for i, j in zip(range(0,106), range(22, 128)):
            first_list = index_name[i:j]
            second_list = index_name[i + 22:j + 22]
            listname.append(caculate_down_propotion(first_list, second_list))

    # print((list_propotion_one))
    # print((list_propotion_two))
    # print((list_propotion_three))
    #
    # print(len(list_propotion_three))
    return list_propotion_one,list_propotion_two,list_propotion_three





def caculate_down_propotion(first_number,second_number):
    """
    计算时间顺序的下降比例
    :param first_number:  必须是列表参数的形式
    :param second_number: 必须是列表参数的形式
    :return:
    """
    # 衡量下降
    #最终储存的比例列表

    # 第一个
    num_old = 0
    for s in first_number:
        num_old = num_old + s
    # print(num_old)

    # 第二个
    num_new = 0
    for t in second_number:
        num_new = num_new + t

    result = (num_new - num_old) / num_old

    return result






def function_encapsulation(first_data,second_data,third_data,fourth_data,listXData_SJz,
                           five_data,seven_data,eight_data,listXData_xian):
    print(five_data)
    print(seven_data)
    print(eight_data)

    def format_fn(tick_val, tick_pos):
        if int(tick_val) in range(len(listXData_SJz)):
            return str(listXData_SJz[int(tick_val)])
        else:
            return ''

    fig = plt.figure(figsize=(12,4))  # ,dpi=450  10, 4 (6,8)
    ax1 = fig.add_subplot(121)
    ax1.xaxis.set_major_formatter(FuncFormatter(format_fn))
    ax1.xaxis.set_major_locator(MaxNLocator(integer=True))
    # plt.ylim((-5, 40))
    # 横坐标每个值旋转90度
    plt.xticks(rotation=45)

    # 坐标轴ticks的字体大小
    ax1.set_xlabel('日期', fontsize=12)  # 为x轴添加标签
    ax1.set_ylabel('经济变化比例', fontsize=12)  # 为y轴添加标签  数值
    ax1.legend()
    plt.rcParams['font.sans-serif'] = ['SimHei']
    plt.rcParams["axes.unicode_minus"] = False

    # 根据需要设置最大最小值，这里设置最大值为1.最小值为0
    # 数据归一化
    tool = MinMaxScaler(feature_range=(0, 1))
    # first_data = tool.fit_transform(array(first_data).reshape(-1,1)).tolist()

    # 石家庄对比经济变化比例
    plt.title("2021年北京指标变化图",fontsize=12)
    plt.xticks(fontsize=12)
    plt.yticks(fontsize=12)

    first_data = tool.fit_transform(array(first_data).reshape(-1, 1)).tolist()
    second_data = tool.fit_transform(array(second_data).reshape(-1, 1)).tolist()
    third_data = tool.fit_transform(array(third_data).reshape(-1, 1)).tolist()
    fourth_data = tool.fit_transform(array(fourth_data).reshape(-1, 1)).tolist()



    plt.plot(listXData_SJz, first_data,  linewidth=1.5,  label="平均点连通性") #"4-",
    plt.plot(listXData_SJz, second_data, linewidth=1.5, label='城市度')  # , "1--"
    plt.plot(listXData_SJz, third_data, linewidth=1.5, label='边数量')  # , ".-"
    plt.plot(listXData_SJz, fourth_data, linewidth=1.5, label='平均最短路径长度')  # , ".-"

    ax1.legend(fontsize=12)  # fontsize=12

    # plt.axhline(y=0, xmin=0, xmax=1,c="r", ls="--", lw=2)
    #
    # # plt.axhspan(ymin=0.4, ymax=0.6, facecolor="g", alpha=0.2)
    #
    # plt.axhspan(ymin=-0.4, ymax=-0.6, facecolor="g", alpha=0.2)
    # # xmin=33, xmax=62
    # plt.axvspan(xmin=36, xmax=62, facecolor='r', alpha=0.2)


    plt.scatter(37, 1, s=50, color='cyan')
    plt.plot([37, 37], [1, 0], 'x--', lw=1.5)
    plt.text(37, 0.90, r'封城开始', fontdict={'size': '12', 'color': 'black'})

    plt.scatter(61, 1, s=50, color='cyan')
    plt.plot([61, 61], [1, 0], 'x--', lw=1.5)
    plt.text(61, 0.90, r'封城结束', fontdict={'size': '12', 'color': 'black'})




    def format_fn_xian(tick_val, tick_pos):
        if int(tick_val) in range(len(listXData_xian)):
            return str(listXData_xian[int(tick_val)])#[4:8]
        else:
            return ''

    ax2 = fig.add_subplot(122)
    ax2.xaxis.set_major_formatter(FuncFormatter(format_fn_xian))
    ax2.xaxis.set_major_locator(MaxNLocator(integer=True))

    # 坐标轴ticks的字体大小
    ax2.set_xlabel('日期', fontsize=12)  # 为x轴添加标签
    ax2.set_ylabel('经济变化比例', fontsize=12)  # 为y轴添加标签  数值


    ax2.legend()

    plt.plot(listXData_xian, five_data, color="#4F9DA6", linewidth=2, label='平均点连通性')  # "4-",
    # plt.plot(listXData_xian, six_data, color="#1663a9", linewidth=2, label='城市度')  # , "1--"
    plt.plot(listXData_xian, seven_data, color="#FFAD5A", linewidth=2, label='边数量')  # , ".-"
    plt.plot(listXData_xian, eight_data, color="#FF5959", linewidth=2, label='平均最短路径长度')  # , ".-"

    plt.title("2021年北京经济变化比例", fontsize=12)
    plt.xticks(fontsize=12, rotation=45)
    plt.yticks(fontsize=12)
    plt.legend(fontsize=12,)  #

    plt.axhline(y=0, xmin=0, xmax=1, c="r", ls="--", lw=2)

    plt.axhspan(ymin=-0.4, ymax=-0.6, facecolor="g", alpha=0.2)

    # plt.axvspan(xmin=30, xmax=54, facecolor='r', alpha=0.2)
    plt.axvspan(xmin=30, xmax=54, facecolor='r', alpha=0.2)

    # plt.scatter(22, 1, s=50, color='cyan')
    # plt.plot([22, 22], [1, 0], 'x--', lw=1.5)
    # plt.text(22, 0.90, r'封城开始', fontdict={'size': '12', 'color': 'black'})
    #
    # plt.scatter(45, 1, s=50, color='cyan')
    # plt.plot([45, 45], [1, 0], 'x--', lw=1.5)
    # plt.text(45, 0.90, r'封城结束', fontdict={'size': '12', 'color': 'black'})



    fig.tight_layout()
    plt.show()








beijing_list=[list_avarge_node_beijing,list_degree_beijing,list_edge_beijing,list_nature_beijing]
tianjin_list=[list_avarge_node_tianjin,list_degree_tianjin,list_edge_tianjin,list_nature_tianjin]
xingtai_list=[list_avarge_node_xingtai,list_degree_xingtai,list_edge_xingtai,list_nature_xingtai]
hengshui_list=[list_avarge_node_hengshui,list_edge_hengshui,list_edge_hengshui,list_nature_hengshui]






#第一幅图石家庄的X轴
list_SJZ_xticks =getdaylist(20211201, 20220316)
listXData_Lock_sjz = getdaylist(20201201, 20210508)




list_propotion_one_Lock_beijing, list_propotion_two_Lock_beijing, list_propotion_three_Lock_beijing = down_propotion_slice(beijing_list)
list_propotion_one_Lock_tianjin, list_propotion_two_Lock_tianjin, list_propotion_three_Lock_tianjin = down_propotion_slice(tianjin_list)
list_propotion_one_Lock_xingtai, list_propotion_two_Lock_xingtai, list_propotion_three_Lock_xingtai = down_propotion_slice(xingtai_list)
list_propotion_one_Lock_hengshui, list_propotion_two_Lock_hengshui, list_propotion_three_Lock_hengshui = down_propotion_slice(hengshui_list)



function_encapsulation(

   #  [-l for l in list(reversed(list_propotion_one_contrast_sjz))], [-l for l in (reversed(list_propotion_two_contrast_sjz))],
   #  [-l for l in list(reversed(list_propotion_three_contrast_sjz))], [-l for l in list(reversed(list_propotion_four_contrast_sjz))],
   #  list(reversed(list_propotion_one_contrast_sjz)),list(reversed(list_propotion_two_contrast_sjz)),
   #  list(reversed(list_propotion_three_contrast_sjz)),list(reversed(list_propotion_four_contrast_sjz)),
   list_avarge_node_beijing,list_degree_beijing,list_edge_beijing,list_nature_beijing,
   listXData_Lock_sjz,
   # list_propotion_one_Lock_beijing, list_propotion_two_Lock_beijing, list_propotion_three_Lock_beijing,
    # list_propotion_one_Lock_tianjin, list_propotion_two_Lock_tianjin, list_propotion_three_Lock_tianjin,
    # list_propotion_one_Lock_xingtai, list_propotion_two_Lock_xingtai, list_propotion_three_Lock_xingtai,
    list_propotion_one_Lock_hengshui, list_propotion_two_Lock_hengshui, list_propotion_three_Lock_hengshui,
   list_SJZ_xticks)





